
> 值轉換器允許在讀取或寫入資料庫時轉換屬性值。

### 設定值轉換器
```C#
public class Rider
{
    public int Id { get; set; }
    public EquineBeast Mount { get; set; }
}

public enum EquineBeast
{
    Donkey,
    Mule,
    Horse,
    Unicorn
}

protected override void OnModelCreating(ModelBuilder modelBuilder)
{
    modelBuilder
        .Entity<Rider>()
        .Property(e => e.Mount)
        .HasConversion(
	        //寫入至資料庫： `ModelClrType` 轉換成 `ProviderClrType`
            v => v.ToString(), 
            
            //從資料庫讀取： `ProviderClrType` 轉換成 。`ModelClrType`
            v => (EquineBeast)Enum.Parse(typeof(EquineBeast), v));
}
```

### 撰寫值轉換器的`Function`：

[ValueConverter 類別](https://learn.microsoft.com/zh-tw/ef/core/modeling/value-conversions?tabs=fluent-api#the-valueconverter-class)

```C#
//<ModelClrType,ProviderClrType>
public class CurrencyConverter : ValueConverter<Currency, decimal>
{
    public CurrencyConverter()
        : base(
	        //寫入至資料庫： `ModelClrType` 轉換成 `ProviderClrType`
            v => v.Amount,
            
            //從資料庫讀取： `ProviderClrType` 轉換成 。`ModelClrType`
            v => new Currency(v))
    {
    }
}

protected override void ConfigureConventions(ModelConfigurationBuilder configurationBuilder)
{
    configurationBuilder
        .Properties<Currency>()
        .HaveConversion<CurrencyConverter>();
}
```

### 使用預先定義的轉換

[內建轉換器](https://learn.microsoft.com/zh-tw/ef/core/modeling/value-conversions?tabs=fluent-api#built-in-converters)

```C#
protected override void OnModelCreating(ModelBuilder modelBuilder)
{
    modelBuilder
        .Entity<Rider>()
        .Property(e => e.Mount)
        
        //直接指定要轉換成的ProviderClrType
        .HasConversion<string>();
}
```

也可直接明確指定資料庫數據行類型：
1. Data Annotation(資料註解)：
```C#
public class Rider2
{
    public int Id { get; set; }

    [Column(TypeName = "nvarchar(24)")]
    public EquineBeast Mount { get; set; }
}
```

2. Fluent API：
```C#
protected override void OnModelCreating(ModelBuilder modelBuilder)
{
    modelBuilder
    .Entity<Rider2>()
    .Property(e => e.Mount)
    .HasColumnType("nvarchar(24)");
}
```
